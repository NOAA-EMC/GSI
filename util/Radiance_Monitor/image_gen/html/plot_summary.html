<!doctype html>
<HTML>

    <!--====================================================================================
    == 12/2014, per WebStorm this document is now HTML5 compliant, using an embedded
    == ccs (cascading style sheet) to replace all deprecated html presentation tags.
    =====================================================================================-->

    <head>
        <!-- ************************************************************-->
        <!-- Make Summary Plots via Google Charts (javascript extension) -->
        <!-- ************************************************************-->


        <!-- load google chart api and local copy of jsuri.js -->
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript" src="jsuri-1.1.1.js"></script>
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

        <script type="text/javascript">

            google.load("visualization", "1", {packages:["corechart"]});

            // on document load event fire the drawCharts() function
            google.setOnLoadCallback(drawCharts);


            // array for retrieved data from the csv file
            var dataProvider  = [];
            var data;
            var data2;
            var data3;
            var data4;

            var url    = window.location.href;
            var src    = new Uri( url ).getQueryParamValue('sat');
            var cycle  = "";
            var initialLoad = true;
            var useComp = false;

            /*
             *  Important note -- javascript handles all paths as relative to the displayed page.  This
             *  makes sense because it doesn't (and shouldn't) have any idea of the server's file
             *  structure (that would be a huge security breach).  I learned this the hard way when I
             *  first tried absolute paths to the comparison files and got a big 404 (file not found)
             *  error in response.  So using compHome with a default value pointing to url of the
             *  operational GDAS plots you can attach pngs/summary/the_file_you_want and retrieve it
             *  that way.
             *
             *  If you want to use a different comparison source, like a control run of a parallel, then
             *  you'll need to extract and plot that data and load it onto the server then change the value
             *  of compHome to point to the top of its directory and compName to the displayed source
             *  name.  Email me (Edward dot Safford at noaa dot gov) if you need help making any of that
             *  happen.
             */
            var compSrc  = "wopr";
            var compName = "GDAS";
            var compHome = "https://www.emc.ncep.noaa.gov/gmb/gdas/radiance/esafford/" + compSrc + "/";

            /****************************************************************************************
             ****************************************************************************************
             *
             *  drawCharts()
             *
             *    Top level drawing function, fired by initial page load and any user change in the
             *    check boxes.
             ****************************************************************************************
             ****************************************************************************************/
            function drawCharts() {


                /***********************************************************************************************
                 * loadCSV()
                 *
                 *   loads data from the input comma separated value file
                 ***********************************************************************************************/
                function loadCSV(file1, file2) {
                    var request;
                    var request2;

                    dataProvider = new Array(2);
                    dataProvider[0] = [];
                    dataProvider[1] = [];

                    log( 'loadCSV, file1, file2 = ' + file1 + ' , ' + file2);
                    if (window.XMLHttpRequest) {
                        // IE7+, Firefox, Chrome, Opera, Safari
                        request  = new XMLHttpRequest();
                        request2 = new XMLHttpRequest();
                    }
                    else {
                        // code for IE6, IE5
                        request  = new ActiveXObject('Microsoft.XMLHTTP');
                        request2 = new ActiveXObject('Microsoft.XMLHTTP');
                    }


                    // load file
                    //   The request object is used to get the file from the server.  Note that this is object oriented
                    //   programming, not procedural.
                    //
                    //   The request.open sets the server instruction to get the requested data file asynchronously.
                    //   Synchronous requests are still possible but most browsers have deprecated that option and will
                    //   eventually remove it.
                    //
                    //   The request.onload() function specifies the actions to take when the data file is loaded;
                    //   the request.status of 200 indicates the load was successful, and request.readystate 4
                    //   indicates the transaction is complete.  The readyState test is included as a sanity check;
                    //   the onload function should only fire when the load is complete or terminated.  The check
                    //   on request.status is necessary; there's no guarantee that the request was successful.
                    //   A warning is dumped to the log in the event of failure, but unless the user has a web
                    //   console (term may vary with browser) open s/he won't see it.
                    //
                    //   The request.send() method actually initiates the processing of the request.

                    request.open('GET', file1, true);
                    log( 'loading ' + file1 );


                    var idx = 0;
                    request.onload = function(e) {
                        if( request.status === 200 && request.readyState === 4 ) {

                            parseCSV( request.responseText, idx );
                            //fillData( idx );

                            // conditionally load comparison file
                            // use check on null condition because a null object doesn't
                            // have a length of 0, it's a type conflict.
                            var file2len;
                            if( file2 == null ) {
                                file2len = 0;
                            }
                            else{
                                file2len = file2.length;
                            }

                            //if( file2.length > 0 ) {
                            if( file2len > 0 ){
                                request2.open( 'GET', file2, true );
                                request2.onload = function(e){
                                    if( request2.status === 200 && request2.readyState === 4 ){
                                        log( 'load request2 completed' );
                                        idx = 1;
                                        parseCSV( request2.responseText, idx );
                                        //fillData( 0 );
                                        //fillCharts( );
                                    } else {
                                        log( " Failed to load " + file2 + " ; request2.status = " + request2. status );
                                        //parseCSV( null, 1 );

                                    }
                                    fillData( 0 );
                                    fillCharts( );
                                }
                                request2.send();
                            }
                            else {
                                fillData( 0 );
                                fillCharts( );
                            }

                            //fillCharts( );  // call this after the comp file is loaded (below)

                        }
                        else {
                            log (" Failed to load " + file1 + " ; request.status = " + request.status );
                        }
                    }
                    request.send();

                }


                /************************************************************************************
                 *  parseCSV( idx )
                 *
                 *    load the comma separated value (CSV) file data into the dataProvider[] array.
                 *    idx should be 0 or 1 for the requested data set or the comparison data set.
                 ************************************************************************************/
                function parseCSV( data, idx ){

                    log("--> parseCSV, idx = " + idx );
                    //replace UNIX new lines
                    data = data.replace(/\r\n/g, "\n");
                    //replace MAC new lines
                    data = data.replace(/\r/g, "\n");
                    //split into rows
                    var rows = data.split("\n");
                    //log( rows.length );
                    var nchanl = 0;


                    // load line 0, which includes the number of channels, and 4 10-digit cycle times
                    if (rows[0]) {
                        var column = rows[0].split(",");
                        var nchanl = parseInt(column[0]);
                        var cycle1 = column[1];
                        var cycle2 = column[2];
                        var cycle3 = column[3];
                        var cycle4 = column[4];

                        // create object which contains all these items:
                        var dataObject = {nchanl: nchanl, cycle1: cycle1, cycle2: cycle2, cycle3: cycle3, cycle4: cycle4};

                        // add object to dataProvider array
                        dataProvider[idx].push(dataObject);
                        log( 'idx, dataProvider[idx][0].nchanl = ' + idx + ', ' + dataProvider[idx][0].nchanl );
                        log( 'idx, dataProvider[idx][0].cycle1 = ' + idx + ', ' + dataProvider[idx][0].cycle1 );
                        log( 'idx, dataProvider[idx][0].cycle4 = ' + idx + ', ' + dataProvider[idx][0].cycle4 );
                    }

                    // loop through rows 1 - nchanl to load the count data (chart 1)
                    for (var i = 1; i <= nchanl; i++) {
                        // this line helps to skip empty rows
                        if (rows[i]) {
                            // our columns are separated by comma
                            var column = rows[i].split(",");

                            // data element order is channel, use flag, cnt cycle1, cnt cycle2, cnt cycl3, cnt cycl4
                            //   items 1-nchan + 1 are the cycle counts for ges data
                            var chan = Number(column[0]);
                            var use = Number(column[1]);
                            var assim;
                            var notassim;
                            if (use === 1) {
                                assim = 1;
                                notassim = undefined;
                            }
                            else {
                                assim = undefined;
                                notassim = 1;
                            }


                            //log( "column.length = " + column.length);

                            var gcyc1 = Number(column[2]);
                            var gcyc2 = Number(column[3]);
                            var gcyc3 = Number(column[4]);
                            var gcyc4 = Number(column[5]);
                            var acyc1 = Number(column[6]);
                            var acyc2 = Number(column[7]);
                            var acyc3 = Number(column[8]);
                            var acyc4 = Number(column[9]);

                            // create object which contains all these items, plus undefined entries for
                            // chart2-4 data:
                            var dataObject = {chan: chan, use: use, assim: assim, notassim: notassim,
                                gcyc1: gcyc1, gcyc2: gcyc2, gcyc3: gcyc3, gcyc4: gcyc4,
                                acyc1: acyc1, acyc2: acyc2, acyc3: acyc3, acyc4: acyc4,
                                // chart 2
                                gtcor1cyc: undefined, gtcor1day: undefined, gtcor30day: undefined,
                                atcor1cyc: undefined, atcor1day: undefined, atcor30day: undefined,
                                // chart 3
                                avg_omgbc_1cyc: undefined, sdv_omgbc_1cyc: undefined,
                                avg_omgbc_30day: undefined, sdv_omgbc_30day: undefined,
                                avg_omabc_1cyc: undefined, sdv_omabc_1cyc: undefined,
                                avg_omabc_30day: undefined, sdv_omabc_30day: undefined,
                                // chart 4
                                ges_pen_1cyc: undefined, ges_pen_1day: undefined, ges_pen_30day: undefined,
                                anl_pen_1cyc: undefined, anl_pen_1day: undefined, anl_pen_30day: undefined};

                            // add object to dataProvider array
                            dataProvider[idx].push(dataObject);
                        }
                    }

                    // loop through rows nchanl+1 - 2*nchanl to load the total bias correction data (chart 2)
                    for (var i = nchanl + 1; i <= 2 * nchanl; i++) {
                        // this line helps to skip empty rows
                        if (rows[i]) {
                            var column = rows[i].split(",");
                            // data element order is channel, use flag, ges:tot_cor:1cycle, ges:tot_cor:4 cycles,
                            //   ges:tot_cor:120 cycles, anl:tot_cor:1 cycle, anl:tot_cor:4 anl:tot_cor:120 cycles

                            dataProvider[idx][i - nchanl].gtcor1cyc = Number(column[2]);
                            dataProvider[idx][i - nchanl].gtcor1day = Number(column[3]);
                            dataProvider[idx][i - nchanl].gtcor30day = Number(column[4]);
                            dataProvider[idx][i - nchanl].atcor1cyc = Number(column[5]);
                            dataProvider[idx][i - nchanl].atcor1day = Number(column[6]);
                            dataProvider[idx][i - nchanl].atcor30day = Number(column[7]);

                        }
                    }

                    // loop through rows nchan*2+1 - 3*nchanl to load the ob[g|a]bc data (chart 3)
                    for (var i = (2 * nchanl) + 1; i <= 3 * nchanl; i++) {
                        // this line helps to skip empty rows
                        if (rows[i]) {
                            var column = rows[i].split(",");
                            // data element order is channel, use flag, avg_omgbc:1cycle, sdv_omgbc:1 cycle,
                            //   avg_omgbc:120 cycles, sdv_omgbc:120 cycles, avg_omabc:1 cycle, sdv_omabc: 1 cycle,
                            //   avg_omabc:120 cycles, sdv_omabc:120 cycles

                            dataProvider[idx][i - nchanl * 2].avg_omgbc_1cyc = Number(column[2]);
                            dataProvider[idx][i - nchanl * 2].sdv_omgbc_1cyc = Number(column[3]);
                            dataProvider[idx][i - nchanl * 2].avg_omgbc_30day = Number(column[4]);
                            dataProvider[idx][i - nchanl * 2].sdv_omgbc_30day = Number(column[5]);
                            dataProvider[idx][i - nchanl * 2].avg_omabc_1cyc = Number(column[6]);
                            dataProvider[idx][i - nchanl * 2].sdv_omabc_1cyc = Number(column[7]);
                            dataProvider[idx][i - nchanl * 2].avg_omabc_30day = Number(column[8]);
                            dataProvider[idx][i - nchanl * 2].sdv_omabc_30day = Number(column[9]);
                        }
                    }

                    // loop through rows nchan*3+1 - 4*nchanl to load the penalty data (chart 4)
                    for (var i = (3 * nchanl) + 1; i <= 4 * nchanl; i++) {
                        // this line helps to skip empty rows
                        if (rows[i]) {
                            var column = rows[i].split(",");
                            // data element order is channel, use flag, ges pen:1cycle, ges pen:1 day,
                            //   ges pen:120 cycles, anl pen:1 cycle, anl pen:1 day, anl pen:120 cycles
                            dataProvider[idx][i - nchanl * 3].ges_pen_1cyc = Number(column[2]);
                            dataProvider[idx][i - nchanl * 3].ges_pen_1day = Number(column[3]);
                            dataProvider[idx][i - nchanl * 3].ges_pen_30day = Number(column[4]);
                            dataProvider[idx][i - nchanl * 3].anl_pen_1cyc = Number(column[5]);
                            dataProvider[idx][i - nchanl * 3].anl_pen_1day = Number(column[6]);
                            dataProvider[idx][i - nchanl * 3].anl_pen_30day = Number(column[7]);
                        }
                    }
                    log("<-- parseCSV");
                }

                //----------------------------------------------------------------------------------------
                // fillData( idx )
                //
                //    fill the data, data2, data3, and data4 objects using the dataProvider object.
                //    idx should be 0 or 1 for the requested data or the comparison data set.
                //----------------------------------------------------------------------------------------
                function fillData( idx ){
                    log( "--> fillData, idx = " + idx );

                    if( dataProvider[0] != "" ) {
                        log( "dataProvider[0] is non-null");
                    }
                    if( dataProvider[1] != "" ){
                        log( "dataProvider[1] is non-null");
                    }


                    // data is the container for the first chart's information.
                    data = new google.visualization.DataTable();
                    data.addColumn('number', 'chan');
                    data.addColumn('number', 'chan assim');
                    data.addColumn('number', 'chan not assim');
                    data.addColumn('number', 'ges ' + dataProvider[0][0].cycle1);
                    data.addColumn('number', 'ges ' + dataProvider[0][0].cycle2);
                    data.addColumn('number', 'ges ' + dataProvider[0][0].cycle3);
                    data.addColumn('number', 'ges ' + dataProvider[0][0].cycle4);
                    data.addColumn('number', 'anl ' + dataProvider[0][0].cycle1);
                    data.addColumn('number', 'anl ' + dataProvider[0][0].cycle2);
                    data.addColumn('number', 'anl ' + dataProvider[0][0].cycle3);
                    data.addColumn('number', 'anl ' + dataProvider[0][0].cycle4);

                    if( dataProvider[1] != "" ) {
                        //data.addColumn('number', 'cmp_ges ' + dataProvider[1][0].cycle1);
                        data.addColumn('number', compName + '_ges ' + dataProvider[1][0].cycle1);
                        data.addColumn('number', compName + '_ges ' + dataProvider[1][0].cycle2);
                        data.addColumn('number', compName + '_ges ' + dataProvider[1][0].cycle3);
                        data.addColumn('number', compName + '_ges ' + dataProvider[1][0].cycle4);
                        data.addColumn('number', compName + '_anl ' + dataProvider[1][0].cycle1);
                        data.addColumn('number', compName + '_anl ' + dataProvider[1][0].cycle2);
                        data.addColumn('number', compName + '_anl ' + dataProvider[1][0].cycle3);
                        data.addColumn('number', compName + '_anl ' + dataProvider[1][0].cycle4);

                        //data.addColumn('number', 'cmp_ges ' + dataProvider[1][0].cycle1);
                        log( 'loading using dataProvider[0] & [1] ');

                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].assim), Number(dataProvider[0][ii].notassim),
                                    Number(dataProvider[0][ii].gcyc1), Number(dataProvider[0][ii].gcyc2),
                                    Number(dataProvider[0][ii].gcyc3), Number(dataProvider[0][ii].gcyc4),
                                    Number(dataProvider[0][ii].acyc1), Number(dataProvider[0][ii].acyc2),
                                    Number(dataProvider[0][ii].acyc3), Number(dataProvider[0][ii].acyc4),
                                    Number(dataProvider[1][ii].gcyc1), Number(dataProvider[1][ii].gcyc2),
                                    Number(dataProvider[1][ii].gcyc3), Number(dataProvider[1][ii].gcyc4),
                                    Number(dataProvider[1][ii].acyc1), Number(dataProvider[1][ii].acyc2),
                                    Number(dataProvider[1][ii].acyc3), Number(dataProvider[1][ii].acyc4)
                                ]
                            ]);

                        }
                    }
                    else {
                        log( 'loading using dataProvider[0]' );
                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].assim), Number(dataProvider[0][ii].notassim),
                                    Number(dataProvider[0][ii].gcyc1), Number(dataProvider[0][ii].gcyc2),
                                    Number(dataProvider[0][ii].gcyc3), Number(dataProvider[0][ii].gcyc4),
                                    Number(dataProvider[0][ii].acyc1), Number(dataProvider[0][ii].acyc2),
                                    Number(dataProvider[0][ii].acyc3), Number(dataProvider[0][ii].acyc4)
                                ]
                            ]);
                        } }

                    // load data2 for chart2
                    data2 = new google.visualization.DataTable();
                    data2.addColumn('number', 'chan');
                    data2.addColumn('number', 'ges 1cyc');
                    data2.addColumn('number', 'ges 1day');
                    data2.addColumn('number', 'ges 30day');
                    data2.addColumn('number', 'anl 1cyc');
                    data2.addColumn('number', 'anl 1day');
                    data2.addColumn('number', 'anl 30day');

                    if( dataProvider[1] != "" ) {
                        data2.addColumn( 'number', compName + '_ges 1cyc'  );
                        data2.addColumn( 'number', compName + '_ges 1day'  );
                        data2.addColumn( 'number', compName + '_ges 30day' );
                        data2.addColumn( 'number', compName + '_anl 1cyc'  );
                        data2.addColumn( 'number', compName + '_anl 1day'  );
                        data2.addColumn( 'number', compName + '_anl 30day' );

                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data2.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].gtcor1cyc), Number(dataProvider[0][ii].gtcor1day),
                                    Number(dataProvider[0][ii].gtcor30day), Number(dataProvider[0][ii].atcor1cyc),
                                    Number(dataProvider[0][ii].atcor1day), Number(dataProvider[0][ii].atcor30day),
                                    Number(dataProvider[1][ii].gtcor1cyc), Number(dataProvider[1][ii].gtcor1day),
                                    Number(dataProvider[1][ii].gtcor30day), Number(dataProvider[1][ii].atcor1cyc),
                                    Number(dataProvider[1][ii].atcor1day), Number(dataProvider[1][ii].atcor30day)]
                            ]);
                        }
                    }
                    else {
                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data2.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].gtcor1cyc), Number(dataProvider[0][ii].gtcor1day),
                                    Number(dataProvider[0][ii].gtcor30day), Number(dataProvider[0][ii].atcor1cyc),
                                    Number(dataProvider[0][ii].atcor1day), Number(dataProvider[0][ii].atcor30day)]
                            ]);
                        }
                    }

                    // load data3 for chart3
                    data3 = new google.visualization.DataTable();
                    data3.addColumn('number', 'chan');
                    data3.addColumn('number', 'avg omgbc 1cyc');
                    data3.addColumn('number', 'sdv omgbc 1cyc');
                    data3.addColumn('number', 'avg omgbc 30day');
                    data3.addColumn('number', 'sdv omgbc 30day');
                    data3.addColumn('number', 'avg omabc 1cyc');
                    data3.addColumn('number', 'sdv omabc 1cyc');
                    data3.addColumn('number', 'avg omabc 30day');
                    data3.addColumn('number', 'sdv omabc 30day');

                    if( dataProvider[1] != "" ) {
                        data3.addColumn('number', compName + '_avg omgbc 1cyc');
                        data3.addColumn('number', compName + '_sdv omgbc 1cyc');
                        data3.addColumn('number', compName + '_avg omgbc 30day');
                        data3.addColumn('number', compName + '_sdv omgbc 30day');
                        data3.addColumn('number', compName + '_avg omabc 1cyc');
                        data3.addColumn('number', compName + '_sdv omabc 1cyc');
                        data3.addColumn('number', compName + '_avg omabc 30day');
                        data3.addColumn('number', compName + '_sdv omabc 30day');

                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data3.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].avg_omgbc_1cyc), Number(dataProvider[0][ii].sdv_omgbc_1cyc),
                                    Number(dataProvider[0][ii].avg_omgbc_30day), Number(dataProvider[0][ii].sdv_omgbc_30day),
                                    Number(dataProvider[0][ii].avg_omabc_1cyc), Number(dataProvider[0][ii].sdv_omabc_1cyc),
                                    Number(dataProvider[0][ii].avg_omabc_30day), Number(dataProvider[0][ii].sdv_omabc_30day),
                                    Number(dataProvider[1][ii].avg_omgbc_1cyc), Number(dataProvider[1][ii].sdv_omgbc_1cyc),
                                    Number(dataProvider[1][ii].avg_omgbc_30day), Number(dataProvider[1][ii].sdv_omgbc_30day),
                                    Number(dataProvider[1][ii].avg_omabc_1cyc), Number(dataProvider[1][ii].sdv_omabc_1cyc),
                                    Number(dataProvider[1][ii].avg_omabc_30day), Number(dataProvider[1][ii].sdv_omabc_30day)]
                            ]);
                        }
                    } else {
                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data3.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].avg_omgbc_1cyc), Number(dataProvider[0][ii].sdv_omgbc_1cyc),
                                    Number(dataProvider[0][ii].avg_omgbc_30day), Number(dataProvider[0][ii].sdv_omgbc_30day),
                                    Number(dataProvider[0][ii].avg_omabc_1cyc), Number(dataProvider[0][ii].sdv_omabc_1cyc),
                                    Number(dataProvider[0][ii].avg_omabc_30day), Number(dataProvider[0][ii].sdv_omabc_30day)]
                            ]);
                        }
                    }

                    // load data4 for chart4
                    data4 = new google.visualization.DataTable();
                    data4.addColumn('number', 'chan');
                    data4.addColumn('number', 'ges_1cyc');
                    data4.addColumn('number', 'ges_1day');
                    data4.addColumn('number', 'ges_30day');
                    data4.addColumn('number', 'anl_1cyc');
                    data4.addColumn('number', 'anl_1day');
                    data4.addColumn('number', 'anl_30day');

                    if( dataProvider[1] != "" ) {

                        data4.addColumn('number', compName + '_ges_1cyc');
                        data4.addColumn('number', compName + '_ges_1day');
                        data4.addColumn('number', compName + '_ges_30day');
                        data4.addColumn('number', compName + '_anl_1cyc');
                        data4.addColumn('number', compName + '_anl_1day');
                        data4.addColumn('number', compName + '_anl_30day');

                        for (var ii = 1; ii < dataProvider[0].length; ii++) {
                            data4.addRows([
                                [Number(dataProvider[0][ii].chan),
                                    Number(dataProvider[0][ii].ges_pen_1cyc), Number(dataProvider[0][ii].ges_pen_1day),
                                    Number(dataProvider[0][ii].ges_pen_30day), Number(dataProvider[0][ii].anl_pen_1cyc),
                                    Number(dataProvider[0][ii].anl_pen_1day), Number(dataProvider[0][ii].anl_pen_30day),
                                    Number(dataProvider[1][ii].ges_pen_1cyc), Number(dataProvider[1][ii].ges_pen_1day),
                                    Number(dataProvider[1][ii].ges_pen_30day), Number(dataProvider[1][ii].anl_pen_1cyc),
                                    Number(dataProvider[1][ii].anl_pen_1day), Number(dataProvider[1][ii].anl_pen_30day)]
                            ]);
                        }

                    } else {

                        for (var ii = 1; ii < dataProvider[idx].length; ii++) {
                            data4.addRows([
                                [Number(dataProvider[idx][ii].chan),
                                    Number(dataProvider[idx][ii].ges_pen_1cyc), Number(dataProvider[idx][ii].ges_pen_1day),
                                    Number(dataProvider[idx][ii].ges_pen_30day), Number(dataProvider[idx][ii].anl_pen_1cyc),
                                    Number(dataProvider[idx][ii].anl_pen_1day), Number(dataProvider[idx][ii].anl_pen_30day)]
                            ]);
                        }
                    }
                    log( "<-- fillData" );
                }


                //---------------------------------------------------------------------------------------
                // fillCharts()
                //   using the loaded data set, construct views (limited data sets) according to the
                //   state of the various checkboxes in the user interface.
                //---------------------------------------------------------------------------------------
                function fillCharts() {
                    //log( "-->fillCharts");

                    /*
                     * options are display options for entire chart
                     * including title, vertical axis label format and scale
                     */
                    var options = {
                        title: 'Number of Observations Passing QC \n' + src + "\n" + cycle,
                        titleTextStyle:{ fontSize: 18 },
                        series: {
                            0: { pointSize: 10, pointShape: { type: 'square' }, color: 'green', lineWidth: 0 },
                            1: { pointSize: 10, pointShape: { type: 'square' }, color: 'red', lineWidth: 0}
                        },
			vAxis:{ format          : '0.##E+0',
                            logScale        : 'false'},
                        hAxis:{ title           : 'Channel',
                            format          :  '##',
                            showTextEvery   :  1
                        },
                        explorer: {
                            actions: ['dragToZoom', 'rightClickToReset'],
                            axis: 'horizontal',
                            keepInBounds: true}
                    };

                    // chart is the count line chart.
                    var chart1 = new google.visualization.LineChart(
                            document.getElementById('sum_count'));

                    window.myValue = data;

                    // add callback for mouse events
                    //google.visualization.events.addListener(chart1, 'select', selectHandler);

                    // create a view for the display of only selected values
                    var myView = new google.visualization.DataView( window.myValue );

                    //
                    // Poll all the checkboxes and set the columns of myView accordingly
                    //
                    var CkBxGes  = document.getElementById( "ckboxGes"  ).checked;
                    var CkBxAnl  = document.getElementById( "ckboxAnl"  ).checked;
                    var CkBxCyc1 = document.getElementById( "ckboxCyc1" ).checked;
                    var CkBxCyc2 = document.getElementById( "ckboxCyc2" ).checked;
                    var CkBxCyc3 = document.getElementById( "ckboxCyc3" ).checked;
                    var CkBxCyc4 = document.getElementById( "ckboxCyc4" ).checked;
                    var CkBxCmp  = false;

                    if( useComp ) {
                        var CkBxCmp = document.getElementById("ckboxCmp").checked;
                    }

                    if( ! CkBxCmp ) {
                        myView.hideColumns([11,12,13,14,15,16,17,18]);
                    }
                    if( ! CkBxGes )  {
                        myView.hideColumns([3,4,5,6,11,12,13,14]);
                    }
                    if( ! CkBxAnl )  {
                        myView.hideColumns([7,8,9,10,15,16,17,18]);
                    }
                    if( !CkBxCyc1 ) {
                        myView.hideColumns([3,7,11,15]);
                    }
                    if( !CkBxCyc2 ) {
                        myView.hideColumns([4,8,12,16]);
                    }
                    if( !CkBxCyc3 ) {
                        myView.hideColumns([5,9,13,17]);
                    }
                    if( !CkBxCyc4 ) {
                        myView.hideColumns([6,10,14,18]);
                    }


                    // add callback for ready (load finished) to add the printable version link
                    // NOTE:  at all costs keep that id="pngN" in the new outerHTML line for the printDiv
                    //        element!!!!!  If you don't have that this solution only works once then "pngN"
                    //        no longer exists.
                    google.visualization.events.addListener(chart1, 'ready', function () {
                        var printDiv = document.getElementById( "png1" );
                        chart1.innerHTML = '<img src="' + chart1.getImageURI() + '">';
                        printDiv.outerHTML = '<a id="png1" class="link_class" href="' + chart1.getImageURI() + '">Num Obs, Printable version </a>';
                    });

                    // display the chart
                    chart1.draw(myView, options);

                    // rename the ckboxCyc1-4 labels using the input cycle times
                    document.getElementById( "labCyc1" ).innerHTML = dataProvider[0][0].cycle1;
                    document.getElementById( "labCyc2" ).innerHTML = dataProvider[0][0].cycle2;
                    document.getElementById( "labCyc3" ).innerHTML = dataProvider[0][0].cycle3;
                    document.getElementById( "labCyc4" ).innerHTML = dataProvider[0][0].cycle4;


                    /******************************************
                     *  chart2 is the total correction plot
                     ******************************************/
                    var options2 = {
                        title: 'Total Bias Correction (K)\n' + src + '\n' + cycle,
                        titleTextStyle:{ fontSize: 18 },
                        vAxis:{ format          : '0.##',
                            logScale        : 'false'},
                        hAxis:{ title           : 'Channel',
                            format          :  '##',
                            showTextEvery   :  1
                        },
                        explorer: {
                            actions: ['dragToZoom', 'rightClickToReset'],
                            axis: 'horizontal',
                            keepInBounds: true}
                    };
                    var chart2 = new google.visualization.LineChart(
                            document.getElementById('total_bias_correction'));

                    // create a view for the display of only selected values
                    var myView2 = new google.visualization.DataView( data2 );

                    var CkBx1Cyc  = document.getElementById( "ckbox1Cyc" ).checked;
                    var CkBx1Day  = document.getElementById( "ckbox1Day").checked;
                    var CkBx30Day = document.getElementById( "ckbox30Day").checked;

                    if( ! CkBxCmp ) {
                        myView2.hideColumns([7,8,9,10,11,12]);
                    }
                    if( ! CkBxGes ){
                        myView2.hideColumns([1,2,3,7,8,9]);
                    }
                    if( ! CkBxAnl ){
                        myView2.hideColumns([4,5,6,10,11,12]);
                    }
                    if( ! CkBx1Cyc ){
                        myView2.hideColumns([1,4,7,10]);
                    }
                    if( ! CkBx1Day ){
                        myView2.hideColumns([2,5,8,11]);
                    }
                    if( ! CkBx30Day){
                        myView2.hideColumns([3,6,9,12]);
                    }

                    //google.visualization.events.addListener(chart2, 'select', selectHandler);
                    google.visualization.events.addListener(chart2, 'ready', function () {
                        var printDiv = document.getElementById( "png2" );
                        chart2.innerHTML = '<img src="' + chart2.getImageURI() + '">';
                        printDiv.outerHTML = '<a id="png2" class="link_class" href="' + chart2.getImageURI() + '">Bias Cor, Printable version </a>';
                    });
                    chart2.draw(myView2, options2);


                    /******************************************************
                     *  chart3 is the om[g|a] plot for 1 cyc and 30 days
                     ******************************************************/
                    var options3 = {
                        title: 'Ges|Anl (with Bias Cor) - Observed (K)\n' + src + '\n' + cycle,
                        titleTextStyle:{ fontSize: 18 },
                        vAxis:{ format          : '0.##',
                            logScale        : 'false'},
                        hAxis:{ title           : 'Channel',
                            format          :  '##',
                            showTextEvery   :  1
                        },
                        explorer: {
                            actions: ['dragToZoom', 'rightClickToReset'],
                            axis: 'horizontal',
                            keepInBounds: true}
                    };
                    var chart3 = new google.visualization.LineChart(
                            document.getElementById('ges_anl_m_obs_w_bias_cor'));

                    //-------------------------------------------------------
                    // create a view for the display of only selected values
                    var myView3 = new google.visualization.DataView( data3 );

                    //-------------------------------------------------------------------
                    // Poll all the checkboxes and set the columns of myView accordingly
                    //
                    var CkBx1CycAvg  = document.getElementById( "ckbox1CycAvg").checked;
                    var CkBx1CycSdv  = document.getElementById( "ckbox1CycSdv").checked;
                    var CkBx30DayAvg = document.getElementById( "ckbox30DayAvg").checked;
                    var CkBx30DaySdv = document.getElementById( "ckbox30DaySdv").checked;

                    if( ! CkBxCmp ) {
                        myView3.hideColumns([9,10,11,12,13,14,15,16]);
                    }
                    if( ! CkBxGes ){
                        myView3.hideColumns([1,2,3,4,9,10,11,12]);
                    }
                    if( ! CkBxAnl ){
                        myView3.hideColumns([5,6,7,8,13,14,15,16]);
                    }
                    if( !CkBx1CycAvg) {
                        myView3.hideColumns([1,5,9,13]);
                    }
                    if( !CkBx1CycSdv){
                        myView3.hideColumns([2,6,10,14]);
                    }
                    if( !CkBx30DayAvg ){
                        myView3.hideColumns([3,7,11,15]);
                    }
                    if( !CkBx30DaySdv ){
                        myView3.hideColumns([4,8,12,16]);
                    }

                    //google.visualization.events.addListener(chart3, 'select', selectHandler);
                    google.visualization.events.addListener(chart3, 'ready', function () {
                        var printDiv = document.getElementById( "png3" );
                        chart3.innerHTML = '<img src="' + chart3.getImageURI() + '">';
                        printDiv.outerHTML = '<a id="png3" class="link_class" href="' + chart3.getImageURI() + '">Ges - Obs, Printable version </a>';
                    });

                    chart3.draw(myView3, options3);


                    /***************************************************************************
                     *  chart4 is the contribution to penalty plot for 1 cyc, 1 day and 30 days
                     ***************************************************************************/
                    var options4 = {
                        title: 'Contribution to Penalty\n' + src + '\n' + cycle,
                        titleTextStyle:{ fontSize: 18 },
                        vAxis:{ format          : '0.##',
                            logScale        : 'false'},
                        hAxis:{ title           : 'Channel',
                            format          :  '##',
                            showTextEvery   :  1
                        },
                        explorer: {
                            actions: ['dragToZoom', 'rightClickToReset'],
                            axis: 'horizontal',
                            keepInBounds: true}
                    };

                    var chart4 = new google.visualization.LineChart(
                            document.getElementById('contribution_to_penalty'));

                    // create a view for the display of only selected values
                    var myView4 = new google.visualization.DataView( data4 );

                    var CkBxPen1Cyc  = document.getElementById( "ckboxPen1Cyc" ).checked;
                    var CkBxPen1Day  = document.getElementById( "ckboxPen1Day").checked;
                    var CkBxPen30Day = document.getElementById( "ckboxPen30Day").checked;

                    if( ! CkBxCmp ) {
                        myView4.hideColumns([7,8,9,10,11,12]);
                    }
                    if( ! CkBxGes ){
                        myView4.hideColumns([1,2,3,7,8,9]);
                    }
                    if( ! CkBxAnl ){
                        myView4.hideColumns([4,5,6,10,11,12]);
                    }
                    if( ! CkBxPen1Cyc ){
                        myView4.hideColumns([1,4,7,10]);
                    }
                    if( !CkBxPen1Day){
                        myView4.hideColumns([2,5,8,11]);
                    }
                    if( ! CkBxPen30Day){
                        myView4.hideColumns([3,6,9,12]);
                    }

                    //google.visualization.events.addListener(chart4, 'select', selectHandler);
                    google.visualization.events.addListener(chart4, 'ready', function () {
                        var printDiv = document.getElementById( "png4" );
                        chart4.innerHTML = '<img src="' + chart4.getImageURI() + '">';
                        printDiv.outerHTML = '<a id="png4" class="link_class" href="' + chart4.getImageURI() + '">Penalty, Printable version </a>';
                    });

                    chart4.draw(myView4, options4);

                    document.getElementById('title').innerHTML = 'Summary Plot   ' + src;
                    document.getElementById('valid').innerHTML = 'Valid:  ' + dataProvider[0][0].cycle1 ;


                    //------------------------------------------------------------------------------------
                    //  store current menu selections in parent.window.value so the current data
                    //  selections can be continued after switching plot types (time/angle/summary/bcoef)
                    //
                    //  Note that an attempt is made to preserve any set channel and stat selections from
                    //  other plot types.  This file (plot_summary.html) can only change the selected sat.
                    //------------------------------------------------------------------------------------
                    //var src    = new Uri( url ).getQueryParamValue('sat');

                    var curSelStr = parent.window.value;
                    var chan      = new Uri( curSelStr ).getQueryParamValue( 'channel' );
                    var stat      = new Uri( curSelStr ).getQueryParamValue( 'stat' );

                    var newSelStr = '?sat=' + src;
                    if( chan ) {
                        newSelStr = newSelStr + '&channel=' + chan;
                    }
                    if( stat ) {
                        newSelStr = newSelStr + '&stat=' + stat;
                    }
                    parent.window.value = newSelStr;

                    //log( "<-- fillCharts");
                }

                /************************************
                 *---------------------------------
                 *  drawCharts code begins here.
                 *---------------------------------
                 ************************************/

                //-----------------------------------------------------------------
                // NOTE: the ckboxCmp will be commented out if comparison plotting
                // is not enabled, which will make the value of loadCmpEl null.
                //
                // If we're using a comparison source other than operational GDAS
                // (the default) then override ckboxCmp.value and label using
                // compSrc (suffix).
                //-----------------------------------------------------------------
                var loadCmpEl = document.getElementById("ckboxCmp");

                if( loadCmpEl ) {
                    useComp = true;
                    if( compHome != "GDAS" ) {
                        loadCmpEl.value = compSrc;
                        log('value of loadCmpEl.value = ' + loadCmpEl.value);

                        var lbl = document.getElementById("ckboxCompLbl");
                        log('value of lbl = ' + lbl.innerHTML);
                        lbl.innerHTML = compName;
                    }
                } else {
                    useComp = false;
                }


                //set platSelect to src, attach callback to platSelect after initial load is complete
                if( initialLoad ) {

                    var platSel = document.getElementById('platformSelect');
                    log( "src = " + src);
                    if( src == undefined ){
                        platSel.selectedIndex = 0;
                        src = platSel.options[platSel.selectedIndex].value;
                    }
                    else {
                        platSel.value = src;
                    }
                    log( "now src = " + src);

                    $.post("./latest_cycle.php?src=" + src, function(data){

                        var strarr=data.split(" ");
                        //var filearr = new Array;
                        var date;

                        for (var i = 0; i < strarr.length; i++) {
                            var isNumber =  /^\d+$/.test(strarr[i]);
                            if (isNumber){
                                cycle = strarr[i];
                            }
                        }
                        log (" cycle from php = " + cycle );

                        var cntFile1, cntFile2;
                        cntFile1 = '';
                        cntFile2 = null;
                        
                        if( cycle.length > 0 ) {
                            var file = src + '.' + cycle + '.sum.txt';
                            cntFile1 = './pngs/summary/' + file ;
                            if( useComp ) {
                                //cntFile2 = '../' + CkBxCmp + '/pngs/summary/' + file;
                                cntFile2 = compHome + 'pngs/summary/' + file;
                            }
                        } else {  // this is old file name format, with no embedded date
                            cntFile1 = './pngs/summary/' + src + '.sum.txt';
                        }
                        log( 'loading cntFile1 = ' + cntFile1 );
                        log( 'loading cntFile2 = ' + cntFile2 );
                        log( ' cycle.length = ' + cycle.length );

                        // load data if this is the first time through this routine otherwise
                        // skip if we're redrawing things.
                        if (dataProvider.length <= 0) {
                            loadCSV( cntFile1, cntFile2 );

                        }
                    });

                    initialLoad = false;
                } else {
                    fillCharts( );
                }

                /*var cntFile;
                if( cycle.length > 0 ) {
                    cntFile = './pngs/summary/' + src + '.' + cycle + '.sum.txt';
                } else {
                    cntFile = './pngs/summary/' + src + '.sum.txt';
                }
                log( 'loading ' + cntFile );
                log( ' cycle.length = ' + cycle.length );

                // load data if this is the first time through this routine otherwise
                // skip if we're redrawing things.
                if (dataProvider.length <= 0) {
                    loadCSV( cntFile );

                }
                else{
                    fillCharts( );
                } */
            }                   // end drawCharts


            // platSelect :  callback for change in select sat/instrument
            function platSelect( value ) {
                log( "--> platSelect " + value);
                //
                // dump all data and reload
                // attempt to reload curChan if that matches a value in the
                // new channel array, otherwise, start at 0.
                //

                // remove all previous channel numbers
                //var chanSel = document.getElementById("chanSelect");
                //while (chanSel.firstChild)
                //    chanSel.removeChild(chanSel.firstChild);

                // reset channel and chart data structures, reset curChan
                //chanData = [];
                //chartData  = [[]];
                //curChan  = 0;

                dataProvider = [];
                initialLoad = true;
                src = value;
                drawCharts();

                log( "<-- platSelect");
            }

        /*********************************************************************************
         * log
         *
         * used for debugging only.
         *
         * It dumps the input msg to the error console.  To see these messages open your
         * "web developer console" (actual term may vary with browser).
         * *******************************************************************************/
        function log(msg) {
            setTimeout(function() {
                throw new Error(msg);
            }, 0);
        }


        /***************************************************************
         * boxCheck
         *
         * redraws charts after a user change to any of the checkboxes.
         ***************************************************************/
        function boxCheck(value) {
            log( 'value = ' + value );
            drawCharts( );
        }


        </SCRIPT>

        <style>
            h2{
                text-align: center;
            }
            h3{
                text-align: center;
            }
            .div_class{
                width: 1100px;
                height: 400px;
                position: relative;
                left: 30px;
            }
            .link_class{
                position: relative;
                left: 140px;
                top:  -40px;
            }
        </style>

    </HEAD>

    <BODY>


        <h2 id=title > Summary Plot </h2>
        <h3 id=valid >Valid </h3>

        <label id="source" style="position: absolute; left: 2px; top:12px"><b> Source:</b></label>

        <!-- NOTE TO SELF:  this needs to revert to the generic install form when
             moved back to svn -->
        <label id="suffix" value="INSERT_SUFFIX" style="position: absolute; left: 72px; top:12px; color: blue"><b>INSERT_SUFFIX</b></label>

        <div id="sum_count" class="div_class"></div>
        <div id="png1" class="link_class"></div>
        <div id="total_bias_correction" class="div_class"></div>
        <div id="png2" class="link_class"></div>
        <div id="ges_anl_m_obs_w_bias_cor" class="div_class"></div>
        <div id="png3" class="link_class"></div>
        <div id="contribution_to_penalty" class="div_class"> </div>
        <div id="png4" class="link_class"></div>

        <form id="satSelectForm" action="" style="position:absolute; left:2px;top:40px">
            <b>Platform:</b>
            <select id="platformSelect" onChange="platSelect(this.value)">
                <!-- This menu will need to be customized by Install_html.sh on wcoss
                     It could be loaded using a php file, but that risks a condition where
                     a source might be missing for some reason, and we should know about that
                     if it was to happen, so it's better that a data load would fail here.  -->
                <!-- INSERT_TABLE -->
<OPTION value="airs_aqua" id="airs_aqua"> AQUA AIRS </OPTION>
<OPTION value="amsua_aqua" id="amsua_aqua"> AQUA AMSU-A </OPTION>
<OPTION value="ssmis_f16" id="ssmis_f16"> F16 SMIS </OPTION>
<OPTION value="ssmis_f17" id="ssmis_f17"> F17 SMIS </OPTION>
<OPTION value="ssmis_f18" id="ssmis_f18"> F18 SMIS </OPTION>
<OPTION value="sndrd1_g13" id="sndrd1_g13"> GOES-13 SNDRD1 </OPTION>
<OPTION value="sndrd2_g13" id="sndrd2_g13"> GOES-13 SNDRD2 </OPTION>
<OPTION value="sndrd3_g13" id="sndrd3_g13"> GOES-13 SNDRD3 </OPTION>
<OPTION value="sndrd4_g13" id="sndrd4_g13"> GOES-13 SNDRD4 </OPTION>
<OPTION value="sndrd1_g15" id="sndrd1_g15"> GOES-15 SNDRD1 </OPTION>
<OPTION value="sndrd2_g15" id="sndrd2_g15"> GOES-15 SNDRD2 </OPTION>
<OPTION value="sndrd3_g15" id="sndrd3_g15"> GOES-15 SNDRD3 </OPTION>
<OPTION value="sndrd4_g15" id="sndrd4_g15"> GOES-15 SNDRD4 </OPTION>
<OPTION value="seviri_m10" id="seviri_m10"> M10 SEVIRI </OPTION>
<OPTION value="amsua_metop-a" id="amsua_metop-a"> METOP-A AMSU-A </OPTION>
<OPTION value="avhrr_metop-a" id="avhrr_metop-a"> METOP-A AVHR </OPTION>
<OPTION value="hirs4_metop-a" id="hirs4_metop-a"> METOP-A HIRS/4 </OPTION>
<OPTION value="iasi_metop-a" id="iasi_metop-a"> METOP-A IASI </OPTION>
<OPTION value="mhs_metop-a" id="mhs_metop-a"> METOP-A MHS </OPTION>
<OPTION value="amsua_metop-b" id="amsua_metop-b"> METOP-B AMSU-A </OPTION>
<OPTION value="hirs4_metop-b" id="hirs4_metop-b"> METOP-B HIRS/4 </OPTION>
<OPTION value="iasi_metop-b" id="iasi_metop-b"> METOP-B IASI </OPTION>
<OPTION value="mhs_metop-b" id="mhs_metop-b"> METOP-B MHS </OPTION>
<OPTION value="amsua_n15" id="amsua_n15"> NOAA-15 AMSU-A </OPTION>
<OPTION value="amsua_n18" id="amsua_n18"> NOAA-18 AMSU-A </OPTION>
<OPTION value="avhrr_n18" id="avhrr_n18"> NOAA-18 AVHR </OPTION>
<OPTION value="mhs_n18" id="mhs_n18"> NOAA-18 MHS </OPTION>
<OPTION value="amsua_n19" id="amsua_n19"> NOAA-19 AMSU-A </OPTION>
<OPTION value="hirs4_n19" id="hirs4_n19"> NOAA-19 HIRS/4 </OPTION>
<OPTION value="mhs_n19" id="mhs_n19"> NOAA-19 MHS </OPTION>
<OPTION value="atms_npp" id="atms_npp"> NPP ATMS </OPTION>
<OPTION value="cris_npp" id="cris_npp"> NPP CRIS </OPTION>
                <!-- END_TABLE_INSERT -->
            </select>
        </form>

<!-- RM line to install OPTIONAL_COMPARE 
                <table style="position:absolute;left:1px;top:80px;width:150px" id="compareTable">
                    <caption style="test-indent:2em"> <b>Compare With:</b> </caption>
                    <tr><td>
                        <input type="checkbox" id="ckboxCmp" name="ckboxCmp" value="wopr" onclick="boxCheck(this.value)"><label id="ckboxCompLbl" for="ckboxCmp">operational GDAS</label></input>
                    </td></tr>
                </table>
     RM line to install OPTIONAL_COMPARE  -->

                <table style="position:absolute;left:1px;top:135px;width:150px">
                   <caption> <b>Data Sets:</b> </caption>
                    <tr><td>
                        <input type="checkbox" id="ckboxGes" name="checkbox" value="gesdata" checked onclick="boxCheck(this.value)"><label for="ckboxGes">ges data</label></input>
                    </td></tr>
                    <tr><td>
                        <input type="checkbox" id="ckboxAnl" name="checkbox" value="anldata" onclick="boxCheck(this.value)"><label for="ckboxAnl">anl data</label></input>
                    </td></tr>
                </table>

                <table style="position:absolute;left:1px;top:220px;width:150px">
                    <caption><b>Last 4 Cycles</b> </caption>
                    <tr><td>
                        <input type="checkbox" id="ckboxCyc1" name="checkbox" value="cycle1" checked onclick="boxCheck(this.value)"><label for="ckboxCyc1" id="labCyc1">cycle 1</label>
                    </td></tr>
                    <tr><td>
                        <input type="checkbox" id="ckboxCyc2" name="checkbox" value="cycle2" checked onclick="boxCheck(this.value)"><label for="ckboxCyc2" id="labCyc2">cycle 2</label>
                    </td></tr>
                    <tr><td>
                        <input type="checkbox" id="ckboxCyc3" name="checkbox" value="cycle3" checked onclick="boxCheck(this.value)"><label for="ckboxCyc3" id="labCyc3">cycle 3</label>
                    </td></tr>
                    <tr><td>
                        <input type="checkbox" id="ckboxCyc4" name="checkbox" value="cycle4" checked onclick="boxCheck(this.value)"><label for="ckboxCyc4" id="labCyc4">cycle 4</label>
                    </td></tr>
                </table>


        <!-- NOTE:  30 Days (below) should be replaced with number of days determined on the fly -->
        <table style="position: absolute;left:1px;top:590px;width:150px">
            <caption><b>Period Averages</b></caption>
            <tr><td>
                <input type="checkbox" id="ckbox1Cyc" name="checkbox" value="1cycle" checked onclick="boxCheck(this.value)"><label for="ckbox1Cyc" id="lab1Cyc">1 Cycle</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckbox1Day" name="checkbox" value="1day" checked onclick="boxCheck(this.value)"><label for="ckbox1Day" id="lab1Day">1 Day</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckbox30Day" name="checkbox" value="30day" checked onclick="boxCheck(this.value)"><label for="ckbox30Day" id="lab30Day">30 Days</label></input>
            </td></tr>
        </table>

<!-- NOTE:  30 Days (below) should be replaced with number of days determined on the fly -->
        <table style="position: absolute;left:1px;top:990px;width:150px">
            <caption><b>Period Avg and Sdv</b></caption>
            <tr><td>
                <input type="checkbox" id="ckbox1CycAvg" name="checkbox" value="1cycleAvg" checked onclick="boxCheck(this.value)"><label for="ckbox1CycAvg" id="lab1CycAvg">1 Cycle Avg</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckbox1CycSdv" name="checkbox" value="1cycleAvg" checked onclick="boxCheck(this.value)"><label for="ckbox1CycSdv" id="lab1CycSdv">1 Cycle Sdv</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckbox30DayAvg" name="checkbox" value="30DayAvg" checked onclick="boxCheck(this.value)"><label for="ckbox30DayAvg" id="lab30DayAvg">30 Day Avg</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckbox30DaySdv" name="checkbox" value="30DaySdv" checked onclick="boxCheck(this.value)"><label for="ckbox30DaySdv" id="lab30DaySdv">30 Day Sdv</label></input>
            </td></tr>
        </table>

<!-- NOTE:  30 Days (below) should be replaced with number of days determined on the fly -->
        <table style="position: absolute;left:1px;top:1390px;width:150px">
            <caption><b>Period Averages</b></caption>
            <tr><td>
                <input type="checkbox" id="ckboxPen1Cyc" name="checkbox" value="1cycle" checked onclick="boxCheck(this.value)"><label for="ckboxPen1Cyc" id="labPen1Cyc">1 Cycle</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckboxPen1Day" name="checkbox" value="1day" checked onclick="boxCheck(this.value)"><label for="ckboxPen1Day" id="labPen1Day">1 Day</label></input>
            </td></tr>
            <tr><td>
                <input type="checkbox" id="ckboxPen30Day" name="checkbox" value="30day" checked onclick="boxCheck(this.value)"><label for="ckboxPen30Day" id="labPen30Day">30 Days</label></input>
            </td></tr>
        </table>

    </BODY>
</HTML>
